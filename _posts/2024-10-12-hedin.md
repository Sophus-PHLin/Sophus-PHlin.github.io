# The Hedin's equation

> Ref: <http://wwwteor.mi.infn.it/~molinari/NOTES/hedin2017.pdf>
> 
> [PDF version](https://Sophus-PHLin.github.io/files/hedin.pdf)

In 1965, Lars Hedin derived the formally closed set of equations for propagator $G$, self-energy $\Sigma_0$, effective potential $W$, proper polarization $\Pi_0$ and dressed vertex $\Gamma$. 

$$
\begin{align}
    G(1,2)&=G_0(1,2)+\int d1'2' G_0(1,1')\Sigma_0(1',2')G(2',2)\\
    W(1,2)&=V(1,2)+\int d1'2' V(1,1')\Pi_0(1',2')W(2',2)\\
    \Sigma_0(1,2)&=i\int d34 W(1,3)\Gamma(3;4,2)G(1,4)\\
    \Pi_0(1,2)&=-i\int d34\Gamma(1;3,4)G(2,4)G(4,2)\\
    \Gamma(1;2,3)&=\delta(1,2)\delta(1,3)+\int d4567 \Gamma(1;4,5)G(6,4)G(5,7)\frac{\partial \Sigma_0(2,3)}{\partial G(6,7)}
\end{align}
$$

Here, $1=(x_1,t_1)$, $V(1,2)=V_0 (x_1,x_2)\delta(t_1-t_2)$ and $G_0$ is Green function with Hartree approximation ("tadpole" diagrams with **exact** particle density).

> In Landau's book, the self energy is decoupled to two parts. One is "branched" diagrams $\Sigma_a$, which is absorbed into $G_0$, and another is $\Sigma_b$, which is $\Sigma_0$ in our notation.
>
> <img src="/images/pub1/1-hartree.png" width=500>

EQU1 and EQU2 are just Dyson's equation. EQU3 and EQU4 gives the skeleton diagram, and EQU5 contains a functional derivative, which is the main difficulty of many-body systems.

We now derive it from a field perspective. We assume that EQU1 is already proved.

## Dyson-Schwinger equation

Consider adding a source term $\phi$ to the Hamiltonian:

$$
H(t)=H_0+U+\int d\vec x\phi(\vec x,t)n(\vec x)
$$

Where $n$ is density operator. We will take $\phi=0$ in the results. The Dyson-Schwinger equation show that

$$
\color{blue}{\frac{\delta}{\delta\phi(x)}\frac{\langle\Omega|\mathcal{T}SF|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}=-i\frac{\langle\Omega|\mathcal{T}SF\delta n(x)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}}
$$

- $F$ is product of field operators
- $\delta n=n-\langle n\rangle$
- $\Omega$ is ground state of $H_I=H_0+U$
- $\displaystyle S=\mathcal{T}\exp \frac{1}{i\hbar}\int d^4 x\phi(x) n(x)$ is the evolution operator
- $n(x)=n(\vec x,t)=e^{iH_It}n(\vec x)e^{-iH_It}$.
- $\langle n(x)\rangle=\dfrac{\langle\Omega|\mathcal{T}Sn(x)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}$

This equation is easily verified by

$$
\frac{\delta \mathcal{T}[SF]}{\delta \phi(x)}=\sum_{k=1}^\infty \frac{(-i)^kk}{k!}\int d1'\dots k'n(1')\dots n(k')\delta(1-1')\phi(2')\dots \phi(k')=-i\mathcal{T}[SFn(x)]
$$

and the definition of $\langle n\rangle$.

## Derivation of Hedin's equation

The first equation is easiest to verify: because $G=g+g(\Sigma_H+\Sigma_0)G$ and $G_0=g+g\Sigma_0 G_0$, then $G=G_0+G_0\Sigma_0 G$. $\Sigma_H$ is contribution from Hartree terms and $g$ is Green function with no interaction.

We define the time-ordered propagator and full polarization as

$$
\begin{align*}
    G(1,2)&=-i\frac{\langle\Omega|\mathcal{T}S\psi(1)\psi^\dag(2)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}\\
    \Pi(1,2)&=-i\frac{\langle\Omega|\mathcal{T}S\delta n(1)\delta n(2)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}\\
\end{align*}
$$

Choosing $F=n$ in DS equation, we have

$$
\frac{\delta}{\delta\phi(2)}\frac{\langle\Omega|\mathcal{T}Sn(1)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}=-i\frac{\langle\Omega|\mathcal{T}Sn(1)\delta n(2)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}=-i\frac{\langle\Omega|\mathcal{T}S\delta n(1)\delta n(2)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}
$$

We express it in Green's function: because $\langle n(1)\rangle=-iG(1,1^+)$, then

$$
\Pi(1,2)=-i\frac{\delta G(1,1^+)}{\delta\phi(2)}
$$

We define a "modified" local potential by adding in Hartree term:

$$
v(1)=\phi(1)-i\int d2V(1,2)G(2,2^+)
$$

Then 
$$
\frac{\delta}{\delta\phi(1)}=\int d2\frac{\delta v(2)}{\delta\phi(1)}\frac{\delta}{\delta v(2)}=\frac{\delta}{\delta v(1)}+\int d23V(2,3)\Pi(3,1)\frac{\delta}{\delta v(2)}
$$

Impose this equation on $-iG$ and defining the proper polarization as $\Pi_0(1,2)=-i\dfrac{\delta G(1,1^+)}{\delta v(2)}$, we have the Dyson's equation for $\Pi$:

$$
\color{blue}{\Pi(1,2)=\Pi_0(1,2)}+\int d34 \Pi_0(1,3) V(3,4) \Pi(4,2)
$$

Define the two-body effective potential as

$$
\begin{align*}
    W(1,3)&=\int d2 \frac{\delta v(1)}{\delta \phi(2)} V(2,3)\\
    &=V(1,3)+\int d24 V(1,4)\Pi(4,2)V(2,3)\\
    &=\color{red}{V(1,3)+\int d24 V(1,4)\Pi_0(4,2)W(2,3)}
\end{align*}
$$

In the last equation, we used $\displaystyle \int d1 V(4,1)\dfrac{\delta}{\delta\phi(1)}=\int d1 W(4,1)\dfrac{\delta}{\delta v(1)}$. **This is the second Hedin's equation.**

We now define the inverse Green function

$$
\int d3 G^{-1}(1,3) G(3,2)=\delta(1,2)
$$

The derivative of $v(4)$ gives

$$
\begin{align*}
    0&=\int d3\frac{\delta G^{-1}(1,3)}{\delta v(4)}G(3,2)+\int d3 G^{-1}(1,3)\frac{\delta G(3,2)}{\delta v(4)}\\
    &=\int d13 G(5,1) \frac{\delta G^{-1}(1,3)}{\delta v(4)}G(3,2)+\frac{\delta G(5,2)}{\delta v(4)}
\end{align*}
$$

In the second equation, we inserted $\int d1 G(5,1)$. Define vertex as

$$
\color{blue}{\Gamma(1;2,3)=-\frac{\delta G^{-1}(2,3)}{\delta \phi(1)}}
$$

Then let $2=5^+$:

$$
\color{red}{\Pi_0(1,2)=-i\int d34 \Gamma(1;3,4)G(3,2)G(4,2)}
$$

**This is the fourth Hedin's equation**.

Now because $G^{-1}(1,2)=G_0^{-1}(1,2)-\Sigma_0(1,2)$, and the equation of motion for $G_0$ is

$$
(i\partial_{t_1}-h(1)-\phi(1)-\int d2 V(1,2)n(2)) G_0(1,2)=\delta(1,2)
$$

Then $G_0^{-1}(1,2)=i\partial_{t_1}-h(1)-v(1)$, and

$$
\Gamma(1;2,3)=\delta(1,2)\delta(1,3)+\frac{\partial \Sigma_0(2,3)}{\partial v(1)}
$$

Because of Hohenberg-Kohn theorem, $G$ is uniquely determined by $V$, then

$$
\frac{\delta}{\delta v(5)}=\int d12 \frac{\delta G(1,2)}{\delta v(5)}\frac{\delta}{\delta G(1,2)}=\int d1234 G(1,4)\Gamma(5;4,3)G(3,2)\frac{\delta}{\delta G(1,2)}
$$

Then

$$
\color{red}{\Gamma(1;2,3)=\delta(1,2)\delta(1,3)+\int d4567 \Gamma(1;4,5)G(6,4)G(5,7)\frac{\partial \Sigma_0(2,3)}{\partial G(6,7)}}
$$

**This is the fifth Hedin's equation.**

Lastly, we consider the equation of motion for $G$. By expanding the time-derivative of the expression of $G$, we obtain

$$
\begin{align*}
    (i\partial_{t_1}-h(1)-v(1))G(1,2)&=\delta(1,2)+\int d3V(1,3)\frac{\langle\Omega|\mathcal{T}S\psi(1)\psi^\dag(2)\delta n(3)|\Omega\rangle}{\langle\Omega|S|\Omega\rangle}\\
    &=\delta(1,2)+i\int d3V(1,3)\frac{\delta G(1,2)}{\delta \phi(3)}
\end{align*}
$$

Let $G=G_0+G_0\Sigma_0 G$, we have

$$
\int d3 \Sigma_0(1,3)G(3,2)=i\int d3V(1,3)\frac{\delta G(1,2)}{\delta \phi(3)}=i\int d3W(1,3)\frac{\delta G(1,2)}{\delta v(3)}
$$

Inserting $\int d2G^{-1}(2,4)$:

$$
\begin{align*}
    \Sigma_0(1,2)&=i\int d34 W(1,3) \frac{\delta G(1,4)}{\delta v(3)} G^{-1}(4,2)\\
    &=-i\int d34 W(1,3)G(1,4)\frac{\delta G^{-1}(4,2)}{\delta v(3)}\\
    &=\color{red}{i\int d34 W(1,3)\Gamma(3;4,2)G(1,4)}
\end{align*}
$$

**This is the third Hedin's equation.**

## Diagrammatic expression of Hedin's equation

EQU1 and EQU2:

<center>
<img src="/images/pub1/1-hedin-1.png" width=500>
</center>

EQU3 and EQU4 (the left is $\Sigma_0$ and the right is $\Pi_0$):

<center>
<img src="/images/pub1/1-hedin-2.png" width=500>
</center>

## GW approximation

The second term in $(5)$ can be neglected in GW, then

$$
\begin{gather*}
    \Gamma(1;2,3)=\delta(1,2)\delta(1,3)\\
    \Sigma_0(1,2)=iG(1,2)W(1,2)\\
    \Pi_0(1,2)=-iG(1,2)G(2,1)
\end{gather*}
$$

And $W$ is determined by $\Pi_0$. This is like the RPA approximation:

<center>
<img src="/images/pub1/1-hedin-3.png" width=500>
</center>

(The first term in the first equation above is absorbed into $G_0$).

> Figures from <https://www.cond-mat.de/events/correl11/manuscripts/held.pdf>